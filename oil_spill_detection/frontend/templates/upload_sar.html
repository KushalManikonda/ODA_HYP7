{% extends 'base.html' %}
{% block content %}
<style>
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes floatUp {
        0% { transform: translateY(0); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(-20px); opacity: 0; }
    }
    
    .upload-container {
        animation: fadeInUp 1s ease-out;
        position: relative;
    }
    
    .page-title {
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.3rem;
        font-weight: 700;
        background: linear-gradient(90deg, #00aaff, #0066cc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        animation: fadeInUp 0.8s ease-out;
    }
    
    .page-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, transparent, #00aaff, transparent);
    }
    
    .card {
        background: rgba(8, 18, 35, 0.60) !important;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0, 170, 255, 0.25) !important;
        border-radius: 20px;
        transition: all 0.5s ease;
        overflow: hidden;
        position: relative;
        box-shadow: 0 15px 35px rgba(4, 12, 26, 0.55);
        animation: fadeInUp 1s ease-out 0.3s both;
    }
    
    .card::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle at center, rgba(0, 170, 255, 0.1) 0%, transparent 70%);
        z-index: -1;
        pointer-events: none;
    }
    
    .card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 170, 255, 0.3);
    }
    
    .card-body {
        padding: 35px;
    }
    
    .card-title {
        font-size: 1.8rem;
        color: #00aaff;
        margin-bottom: 20px;
        position: relative;
        display: inline-block;
    }
    
    .card-title::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 40px;
        height: 2px;
        background: #00aaff;
    }
    
    .card-text {
        color: rgba(200, 235, 255, 0.90);
        margin-bottom: 30px;
        font-size: 1.1rem;
    }
    
    .upload-form {
        background: rgba(4, 12, 26, 0.55);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 30px;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(8, 18, 35, 0.60);
    }
    
    .form-label {
        color: #00aaff;
        font-weight: 600;
        margin-bottom: 15px;
        display: block;
    }
    
    .form-control-file {
        border: 2px dashed rgba(0, 170, 255, 0.4);
        padding: 50px 20px;
        border-radius: 15px;
        text-align: center;
        transition: all 0.3s ease;
        background: rgba(4, 12, 26, 0.55);
        color: white;
        position: relative;
        cursor: pointer;
    }
    
    .form-control-file::before {
        content: '\f093';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        font-size: 3rem;
        color: rgba(0, 170, 255, 0.6);
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
    }
    
    .form-control-file::after {
        content: 'Drop your SAR image here or click to browse';
        position: absolute;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        white-space: nowrap;
        color: rgba(180, 225, 255, 0.80);
    }
    
    .form-control-file:hover {
        background: rgba(0, 170, 255, 0.1);
        transform: scale(1.02);
        border-color: #00aaff;
    }
    .form-control-file.file-selected::before {
        display: none;
    }
    .form-control-file.file-selected::after {
        content: attr(data-filename);
        color: rgba(180, 225, 255, 0.90);
    }
    
    .btn-process {
        background: linear-gradient(135deg, #00aaff 0%, #0066cc 100%);
        border: none;
        padding: 15px 30px;
        font-size: 1.2rem;
        font-weight: 600;
        letter-spacing: 1px;
        border-radius: 30px;
        margin-top: 20px;
        transition: all 0.3s ease;
        box-shadow: 0 10px 20px rgba(0, 170, 255, 0.3);
        position: relative;
        overflow: hidden;
        z-index: 1;
    }
    
    .btn-process::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: all 0.6s;
        z-index: -1;
    }
    
    .btn-process:hover::before {
        left: 100%;
    }
    
    .btn-process:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 170, 255, 0.5);
    }
    
    .results-section {
        animation: fadeInUp 1s ease-out;
        margin-top: 40px;
        position: relative;
    }
    
    .results-title {
        text-align: center;
        margin-bottom: 25px;
        color: #00aaff;
        font-size: 1.8rem;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
    }
    
    .results-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, transparent, #00aaff, transparent);
    }
    
    .result-image-container {
        position: relative;
        overflow: hidden;
        border-radius: 15px;
        box-shadow: 0 15px 30px rgba(4, 12, 26, 0.65);
        margin-bottom: 30px;
    }
    
    .result-image {
        width: 100%;
        transition: transform 0.5s ease;
        border: none !important;
        display: block;
    }
    
    .result-image:hover {
        transform: scale(1.05);
    }
    
    .area-display {
        font-size: 1.5rem;
        color: #00aaff;
        font-weight: bold;
        text-align: center;
        margin: 20px 0;
        text-shadow: 0 0 10px rgba(0, 170, 255, 0.3);
        animation: pulse 3s infinite;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); text-shadow: 0 0 10px rgba(0, 170, 255, 0.3); }
        50% { transform: scale(1.03); text-shadow: 0 0 15px rgba(0, 170, 255, 0.5); }
        100% { transform: scale(1); text-shadow: 0 0 10px rgba(0, 170, 255, 0.3); }
    }
    
    .floating-bubble {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: rgba(0, 170, 255, 0.3);
        pointer-events: none;
        animation: floatUp 10s infinite linear;
    }
</style>

<div class="upload-container">
    <!-- Add floating bubbles with JS -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.upload-container');
            
            for (let i = 0; i < 20; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('floating-bubble');
                
                // Random positioning
                bubble.style.left = Math.random() * 100 + '%';
                bubble.style.bottom = Math.random() * 20 + '%';
                
                // Random size
                const size = Math.random() * 10 + 5;
                bubble.style.width = size + 'px';
                bubble.style.height = size + 'px';
                
                // Random opacity
                bubble.style.opacity = Math.random() * 0.5 + 0.1;
                
                // Random animation duration and delay
                const duration = Math.random() * 15 + 5;
                bubble.style.animationDuration = duration + 's';
                bubble.style.animationDelay = Math.random() * 5 + 's';
                
                container.appendChild(bubble);
            }
        });
    </script>

    <h2 class="page-title">
        <i class="fas fa-satellite mr-2"></i>SAR Image Analysis
    </h2>
    
    <div class="card">
        <div class="card-body">
            <h3 class="card-title">
                <i class="fas fa-file-upload mr-2"></i>Upload SAR Image
            </h3>
            <p class="card-text">
                Upload a Synthetic Aperture Radar (SAR) image for oil spill detection using our advanced AI model.
                Our system works effectively in all weather conditions and can detect oil spills on various water surfaces.
            </p>
            
            <div class="upload-form">
                <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_sar') }}">
                    <div class="form-group">
                        <label for="file" class="form-label">
                            <i class="fas fa-image mr-2"></i>Select SAR Image File
                        </label>
                        <input type="file" class="form-control-file" id="file" name="file" accept="image/*" required
                               onchange="this.classList.add('file-selected'); this.setAttribute('data-filename', this.files[0]?.name || '')">
                    </div>
                    <button type="submit" class="btn btn-process btn-block">
                        <i class="fas fa-cogs mr-2"></i>Process Image
                    </button>
                </form>
            </div>

            {% if result_image %}
            <div id="results" class="results-section">
                <h4 class="results-title">
                    <i class="fas fa-chart-line mr-2"></i>Processing Results
                </h4>
                <div class="result-image-container">
                    <img src="{{ url_for('static', filename='outputs/' + result_image) }}" 
                         alt="Processing Result" 
                         class="result-image img-fluid">
                </div>
                {% if oil_area is not none %}
                <div class="area-display">
                    <i class="fas fa-ruler-combined mr-2"></i>Detected Oil Area: {{ oil_area }} m²
                </div>
                {% endif %}
            </div>
            {% endif %}

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="mt-4">
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }} animate__animated animate__fadeIn">
                                {% if category == 'success' %}
                                    <i class="fas fa-check-circle mr-2"></i>
                                {% elif category == 'danger' %}
                                    <i class="fas fa-exclamation-circle mr-2"></i>
                                {% elif category == 'warning' %}
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                {% endif %}
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>
{% endblock %}